https://blog.csdn.net/wxl1555/article/details/52736498

> 当下的互联网应用都包含大量的静态内容，但静态内容以及一些准动态内容又是最耗费带宽的，
特别是针对全国甚至全世界的大型网站，如果这些请求都指向主站的服务器的话，
不仅是主站服务器受不了，单端口500M左右的带宽也扛不住，所以大多数网站都需要CDN服务。

# 1. 什么是CDN服务？

CDN，Content Delivery Network，基于内容的分布式分发网络。 

简单的说CDN就是让原本上海的浏览器要访问北京主站内容的请求转而由部署在上海或南京的缓存来受理，
这样请求的数据只需经过一跳或有限的几跳就能到达请求端，有效利用带宽并且降低主站压力

CDN设计目的是实现WEB内容的负载均衡，防止出现访问请求热点，延时响应等WEB请求通病。基于此，CDN的特点可以说有 
1. 分布式存储 
2. 通过智能DNS解析或http重定向实现内容分发的负载均衡 
3. 全局负载均衡管理与内容管理

# 2. CDN工作原理

CDN网络是在用户和服务器之间增加Cache层， 如何将用户的请求引导到Cache上获得源服务器的数据

> 过程
1. 用户向浏览器提供要访问的域名;
2. 浏览器调用域名解析库对域名进行解析，由于CDN对域名解析过程进行了调整，所以解析函数库一般得到的是该域名对应的CNAME记录，
为了得到实 际IP地址，浏览器需要再次对获得的CNAME域名进行解析以得到实际的IP地址;
在此过程中，使用的全局负载均衡DNS解析，如根据地理位置信息解析对应的IP地址，使得用户能就近访问。
3. 此次解析得到CDN缓存服务器的IP地址，浏览器在得到实际的IP地址以后，向缓存服务器发出访问请求;
4. 缓存服务器根据浏览器提供的要访问的域名，通过Cache内部专用DNS解析得到此域名的实际IP地址，
再由缓存服务器向此实际IP地址提交访问请求;
5. 缓存服务器从实际IP地址得得到内容以后，一方面在本地进行保存，以备以后使用，
二方面把获取的数据返回给客户端，完成数据服务过程;


> 具体案例

1.用户向浏览器输入www.web.com这个域名，浏览器第一次发现本地没有dns缓存，则向网站的DNS服务器请求； 
2.网站的DNS域名解析器设置了CNAME，指向了www.web.51cdn.com,请求指向了CDN网络中的智能DNS负载均衡系统； 
3.智能DNS负载均衡系统解析域名，把对用户响应速度最快的IP节点返回给用户； 
4.用户向该IP节点（CDN服务器）发出请求； 
5.由于是第一次访问，CDN服务器会向原web站点请求，并缓存内容； 
6.请求结果发给用户。

图片见 https://blog.csdn.net/wxl1555/article/details/52736498
