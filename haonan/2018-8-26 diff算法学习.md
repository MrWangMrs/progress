# diff算法学习
+ 在未来的几周中将精力放在Vue/React-diff算法的学习上
+ 理解思路，尝试理解源码实现

# 概念
#### 什么是虚拟dom
真实dom是一层树结构，虚拟dom是对真实dom树的一层抽象。用key-value的形式对真实dom的各个特性进行记录，框架内部再利用这些属性转化为真实dom用于浏览器渲染
#### 为什么要有虚拟dom
那么，使用虚拟dom有什么好处呢？
+ 在jq的年代，我们常直接对dom进行频繁的操作，这样会导致浏览器频繁的重绘与回流
+ 利用虚拟dom这层结构，我们可以更主动的控制需要渲染的内容
+ 虚拟dom可以将我们大量的dom操作、更改统一处理，通过算法比较前后的差异，计算出最小化的更新，减少浏览器重绘与回流的频率，提升性能
#### diff算法
diff算法就是虚拟dom用来比较前后差异的一种实现，Vue/React各有一套自身的diff算法

# Vue-diff
## 思路
在Vue中，**VNode**就是它的虚拟dom，而diff算法就是通过比较VNode的差别来计算出需要更新的节点，diff算法之所以性能高，原因在于其比较的方式，如下图所示：
![vue-diff算法图示](http://op4gevqna.bkt.clouddn.com/blog_vue-diff%E7%AE%97%E6%B3%95%E5%9B%BE%E7%A4%BA.png)
+ diff算法只会比较同层级之间的差别，每个层级进行单独比较，找出差异
+ 当同级VNode进行比较的时候，只对相同的VNode进行比较，如果VNode不相同，则直接进行dom的增或删

#### 如何认为这是一个相同的VNode
+ key
+ tag（当前节点的标签名）
+ 注释节点
+ data（当前节点对应的对象，包含了具体的一些数据信息，例如标签的attr、class等）
+ 当标签是``input``的时候，其type

#### 相同的VNode怎么比
+ key相同并且都是静态的，并且新的VNode是clone或者是标记了once（标记v-once属性，只渲染一次），那么只需要替换elm以及componentInstance即可
+ 新旧节点均有子节点，对子节点进行比较
+ 老节点没有子节点，新节点有子节点，将子节点直接加入新节点
+ 老节点有子节点，新节点没有子节点，直接清空所有子节点
+ 新老节点都无子节点，替换文本即可